<BoxLayout>:
    control_text_width: 200
    element_height_1: '40dp'
    element_height_2: '80dp'
    element_height_rbw: '60dp'
    element_spacing: 10

<MDRaisedButton>:
    font_size: sp(16)  # Apply to all MDRaisedButtons

<MDLabel>:
    font_size: sp(16)  # Apply to all MDLabels

<MDTextField>:
    font_size: sp(16)  # Apply to all MDTextFields
    text_color_normal: 0, 0, 0, 1

<IPDialogContent>:
    orientation: 'vertical'
    MDTextField:
        id: ip_input
        hint_text: "Enter IP address (xx.x.x.xx)"
        text: app.ip_address
        size_hint_x: 0.5
        pos_hint: {"center_x": 0.5, "center_y": 0}
    MDLabel:
        id: error_label
        text: ""
        color: 1, 0, 0, 1  # Red color for error message
        halign: "center"


# Main window to fit vertically: Spectrum screen, labels, and buttons
BoxLayout:
    orientation: 'vertical'

    # Top window to fit the connection label, and Spectrum screen
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: 0.5

        # Connection label
        MDCard:
            id: connection_card
            size_hint: 0.2, None
            size: "300dp", "50dp"
            pos_hint: {"center_x": 0.1, "center_y": 0.9}
            elevation: 4  # Shadow depth
            radius: [5, ]  # Rounded corners if needed
            padding: '10dp'
            md_bg_color: app.color_red
            opacity: 1
            orientation: 'vertical'

            MDLabel:
                id: connection_label
                halign: "center"
                padding: 10
                font_size: 15
                text: "Disconnected"

        # Spectrum screen
        Image:
            size_hint_x: 0.8
            source: 'Temp pic.png'

    # Two columns of labels
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: 0.5  # Bottom half of the window
        padding: 10

        # Left Side labels
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.5
            spacing: root.element_spacing

            # Start Frequency
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_2
                spacing: root.element_spacing

                MDLabel:
                    text: "Start Frequency [kHz]: "
                    size_hint_x: None
                    width: root.control_text_width

                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: root.element_height_2
                    spacing: root.element_spacing

                    MDTextField:
                        id: start_input
                        hint_text: "Enter start frequency"
                        text: str(app.start_frequency)
                        input_filter: 'float'
                        on_text_validate: app.set_start_frequency(self.text)

                    MDSlider:
                        id: slider_start
                        min: app.spectrum_range_start
                        max: app.spectrum_range_stop
                        value: app.start_frequency
                        step: 1
                        on_value: app.update_start_slider(self.value)

            # Stop Frequency
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_2
                spacing: root.element_spacing

                MDLabel:
                    text: "Stop Frequency [kHz]: "
                    size_hint_x: None
                    width: root.control_text_width

                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: root.element_height_2
                    spacing: root.element_spacing

                    MDTextField:
                        id: stop_input
                        hint_text: "Enter stop frequency"
                        text: str(app.stop_frequency)
                        input_filter: 'float'
                        on_text_validate: app.set_stop_frequency(self.text)

                    MDSlider:
                        id: slider_stop
                        min: app.spectrum_range_start
                        max: app.spectrum_range_stop
                        value: app.stop_frequency
                        step: 1
                        on_value: app.update_stop_slider(self.value)

            # RBW
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_rbw
                spacing: root.element_spacing

                MDLabel:
                    text: "RBW [kHz]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.rbw)
                    hint_text: "Enter RBW"
                    input_filter: 'float'

            # VBW
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "VBW [kHz]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.vbw)
                    hint_text: "Enter VBW"
                    input_filter: 'float'

            # Dropdown - Test type (frequency selector)
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1

                MDLabel:
                    text: "Test type: "
                    size_hint_x: None
                    width: root.control_text_width

                MDDropDownItem:
                    id: test_type_dropdown
                    text: "Full range"  # Set default value
                    on_release: app.menu_test_type.open()

        # Right Side labels
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.5
            padding: 10
            spacing: root.element_spacing

            # Dropdown - Traces (Avg and MH)
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "Traces: "
                    size_hint_x: None
                    width: root.control_text_width

                MDDropDownItem:
                    id: traces_dropdown
                    text: "Average"  # Set default value
                    on_release: app.menu_traces.open()

            # Impedance
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "Impedance [ohm]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.impedance)
                    hint_text: "Enter impedance"
                    input_filter: 'int'

            # Dropdown - Coupling (AC and DC)
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1

                MDLabel:
                    text: "Coupling: "
                    size_hint_x: None
                    width: root.control_text_width

                MDDropDownItem:
                    id: coupling_dropdown
                    text: "AC"  # Set default value
                    on_release: app.menu_coupling.open()

            # Dropdown - Average Type (Log and RMS)
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1

                MDLabel:
                    text: "Average type: "
                    size_hint_x: None
                    width: root.control_text_width

                MDDropDownItem:
                    id: avg_type_dropdown
                    text: "Log"  # Set default value
                    on_release: app.menu_avg_type.open()

            # Attenuation
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "Attenuation [dB]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.attenuation)
                    hint_text: "Enter attenuation"
                    input_filter: 'float'

            # Reference Level
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "Reference Level [dBm]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.reference_level)
                    hint_text: "Enter reference level"
                    input_filter: 'float'

            # Y Reference Level
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: root.element_height_1
                spacing: root.element_spacing

                MDLabel:
                    text: "Y Reference Level [dBm]: "
                    size_hint_x: None
                    width: root.control_text_width

                MDTextField:
					text: str(app.y_reference_level)
                    hint_text: "Enter Y reference level"
                    input_filter: 'float'

    # Buttons centered at the bottom
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        size_hint_x: 1
        height: '50dp'
        spacing: 50
        padding: 10
        # Center the buttons
        pos_hint: {"center_x": 0.5, "center_y": 0}  # Center horizontally at the bottom

        MDRaisedButton:
            id: connection_button
            text: "Connect"
            size_hint_x: 0.2
            on_release: app.spectrum_connection()

        MDRaisedButton:
            text: "Config"
            size_hint_x: 0.2
            on_release: app.config_spectrum()

        MDRaisedButton:
            text: "Reset"
            size_hint_x: 0.2
            on_release: app.reset_spectrum()

        MDRaisedButton:
            text: "Run"
            size_hint_x: 0.2
            on_release: app.run_traces()

        MDRaisedButton:
            text: "Stop"
            size_hint_x: 0.2
            on_release: app.stop_traces()
