# function to call the main analysis/synthesis functions in software/models/dftModel.py

import numpy as np
from scipy import signal
import matplotlib.pyplot as plt
import os, sys
sys.path.append(os.path.join(os.path.dirname(os.path.realpath(__file__)), '../models/'))

#import dftModel as DFT
import pandas as pd
import scipy as sp
import plotly as py
import plotly.graph_objs as go
from plotly.subplots import make_subplots
from typing import Tuple

def fft (s_time: np.ndarray , n_samples: int ) -> Tuple[np.ndarray] :#FFT process
    s_time_t = s_time.T
    s_fft= sp.fft.fft(s_time_t)
    s_fft_abs = np.abs(s_fft/n_samples).T
    #FFT - taking only half of the data [fft output only contain half of "real" data,
    #the other half is just a mirror]
    s_hs = s_fft_abs[0:int((n_samples/2)+1)]
    #Throwing bit 0 (dc component), also multipling by 2 , because we remove half the data
    #then we will need to divide bt sqrt(2) in order to get rms
    s_hs[1:int(n_samples/2+1)] = 2*s_hs[1:int(n_samples/2+1)];

    return s_hs


def main(inputFile = r"C:\Users\noam.d\Desktop\Noam DahanThresholdingAlgo\MANA2.txt",Fs=50e3):
    """

    """
    col = 2
    row=2
    all_specs = np.array([[{"secondary_y": True}] for x in range((row*col))])

    all_specs_reshaped = np.reshape(all_specs, (col, row)).T.tolist()

    fig = make_subplots(rows=row, cols=col,subplot_titles=("Linear PSD of S(t)", "logarithmic PSD of S(t)", "Max Hold and AVG of Spectrum of S(t)", "Noam Dahan fft"),
                         specs=all_specs_reshaped, shared_xaxes=True)

    df=pd.read_csv(inputFile);

    sb = [-5.816987087, -6.989700043, -7.35182177, -8.446639625, -7.099653886, -5.128616245, -5.968794788, -6.925039621,
          -8.01342913, -9.20818754, -8.996294549, -9.507819773, -10.26872146, -11.3667714, -8.181564121, -9.393021596,
          -3.010299957, -3.936186349, -3.757179042, -3.545777307, -4.48550002, -4.16801226, -6.16184634, -6.675615401,
          -7.904849855, -9.100948886, -9.586073148, -9.355420108, -7.670038896, -7.878123956, -9.318141383,
          -5.482135645, -6.32644079, -7.772835289, -7.569619513, -8.96196279, -10.13228266, -8.794260688, -9.172146297,
          -10.65501549, -8.927900304, -7.520267336, -6.615435064, -7.721132954, -9.136401693, -9.281179927,
          -10.55517328, -9.829666607, -9.469215565, -9.625735021, -10.17728767, -4.282911682, -5.734887386,
          -4.934949676, -6.143937264, -6.615435064, -7.772835289, -8.153085692, -8.569851997, -9.586073148,
          -6.363880201, -7.79891912, -8.894102897, -8.239087409, -6.345120151, -7.746907183, -5.900668767, -7.166987713,
          -6.798537139, -7.281583935, -7.077439286, -8.416375079, -8.664610916, -9.100948886, -8.664610916, -7.85156152,
          -7.825160558, -8.894102897, -8.696662315, -9.355420108, -8.601209136, -9.706162223, -11.02372909, -7.79891912,
          -6.989700043, -8.386319978, -7.772835289, -8.927900304, -7.189666328, -5.30177984, -6.615435064, -7.695510786,
          -8.76148359, -9.706162223, -12.14670165, -11.13509275, -12.2184875, -12.59637311, -8.728952016, -8.153085692,
          -9.318141383, -8.297382846, -7.746907183, -6.777807053, -7.79891912, -9.244530386, -9.03089987, -7.772835289,
          -8.996294549, -9.355420108, -8.632794328, -8.446639625, -10.96910013, -12.2184875, -8.696662315, -10,
          -11.42667504, -12.2184875, -9.956786262, -10.91514981, -11.67491087, -10.80921908, -12.29147988, -13.66531544,
          -10.50609993, -10.17728767, -10.65501549, -11.73925197, -9.507819773, -6.615435064, -7.85156152, -7.258421507,
          -8.632794328, -7.79891912, -8.996294549, -9.136401693, -9.829666607, -8.996294549, -7.695510786, -8.356471442,
          -8.794260688, -9.625735021, -5.88380294, -5.816987087, -5.900668767, -5.4668166, -4.68521083, -4.74955193,
          -4.962093169, -6.401645177, -6.968039426, -7.746907183, -6.458915609, -7.121982701, -5.71865206, -6.038006529,
          -6.635402662, -7.986028757, -8.728952016, -6.798537139, -7.077439286, -7.375489103, -8.696662315,
          -6.458915609, -6.16184634, -5.833594927, -6.655462488, -7.520267336, -7.121982701, -5.331323796, -5.85026652,
          -6.25251654, -5.257837359, -7.423214251, -7.011469236, -8.268137316, -9.355420108, -8.096683018, -9.469215565,
          -10.17728767, -11.48741651, -7.328282716, -8.041003476, -7.39928612, -7.258421507, -5.751183634, -4.710832997,
          -6.073030467, -8.664610916, -6.536470255, -7.85156152, -8.326826653, -8.696662315, -8.356471442, -7.495799977,
          -6.989700043, -8.416375079, -7.447274949, -8.696662315, -9.829666607, -8.181564121, -8.356471442, -10,
          -9.706162223, -7.695510786, -8.538719643, -8.124792792, -9.430951487, -10.36212173, -11.80456064,
          -12.14670165, -10.08773924, -8.632794328, -7.904849855, -8.569851997, -8.996294549, -9.913998282,
          -10.26872146, -9.956786262, -8.728952016, -10.96910013, -10.96910013, -9.318141383, -8.356471442,
          -9.136401693, -9.871627753, -7.93174124, -7.033348097, -6.903698326, -7.447274949, -8.827287043, -10.17728767,
          -10.80921908, -10.91514981, -7.121982701, -7.721132954, -7.746907183, -7.986028757, -8.297382846,
          -7.619538969, -8.601209136, -9.136401693, -8.632794328, -9.956786262, -8.794260688, -9.871627753,
          -11.02372909, -11.73925197, -10.13228266, -11.13509275, -11.13509275, -11.3667714, -11.42667504, -11.13509275,
          -12.51811973, -8.76148359, -10.17728767, -9.136401693, -8.601209136, -4.546928835, -5.867002359, -6.695862267,
          -7.986028757, -8.386319978, -8.181564121, -9.393021596, -8.696662315, -9.281179927, -10.50609993,
          -11.61150909, -12.59637311, -11.19186408, -10.65501549, -11.42667504, -10.75720714, -10.17728767,
          -10.75720714, -6.635402662, -5.833594927, -6.989700043, -7.569619513, -8.068754016, -9.03089987, -8.696662315,
          -7.85156152, -6.073030467, -7.35182177, -7.447274949, -7.447274949, -7.495799977, -7.958800173, -7.304870558,
          -6.234230429, -7.281583935, -8.297382846, -8.632794328, -9.281179927, -7.878123956, -8.239087409,
          -7.166987713, -7.21246399, -8.268137316, -9.665762445, -10.91514981, -10.65501549, -10.91514981, -11.93820026,
          -10.08773924, -9.829666607, -9.665762445, -10.36212173, -7.746907183, -8.210230527, -9.586073148,
          -7.619538969, -8.860566477, -9.746941347, -8.538719643, -9.281179927, -10.26872146, -9.956786262,
          -10.13228266, -10.40958608, -8.507808873, -8.068754016, -8.728952016, -9.913998282, -7.39928612, -8.728952016,
          -8.664610916, -9.625735021, -10.86186148, -11.80456064, -11.19186408, -9.665762445, -8.996294549,
          -10.26872146, -8.068754016, -8.268137316, -9.393021596, -10.31517051, -9.829666607, -11.24938737,
          -11.48741651, -11.24938737, -6.234230429, -7.544873322, -6.989700043, -8.386319978, -9.393021596,
          -9.355420108, -10.55517328, -10.96910013, -11.5490196, -7.14442691, -8.326826653, -9.065783148, -9.871627753,
          -9.03089987, -8.894102897, -9.546770212, -7.772835289, -8.664610916, -7.695510786, -8.696662315, -8.096683018,
          -8.696662315, -6.32644079, -7.304870558, -7.904849855, -9.03089987, -10.36212173, -11.67491087, -12.36572006,
          -7.878123956, -8.268137316, -7.011469236, -7.375489103, -7.904849855, -5.670307091, -5.331323796,
          -6.635402662, -6.861327796, -7.235381958, -7.569619513, -7.619538969, -8.728952016, -9.03089987, -8.297382846,
          -8.507808873, -7.423214251, -8.728952016, -8.927900304, -8.794260688, -10.17728767, -11.19186408,
          -9.065783148, -8.827287043, -10, -7.21246399, -3.79863945, -4.473317839, -5.63837353, -5.044556625,
          -6.020599913, -7.447274949, -8.728952016, -6.556077263, -7.958800173, -8.664610916, -8.569851997,
          -8.728952016, -9.281179927, -10.40958608, -10.70581074, -10.86186148, -11.3667714, -11.5490196, -9.829666607,
          -8.538719643, -8.210230527, -9.665762445, -9.788107009, -10.55517328, -10.60480747, -11.80456064,
          -11.42667504, -12.36572006, -12.29147988, -12.29147988, -13.56547324, -12.2184875, -10.86186148, -12.29147988,
          -11.42667504, -9.281179927, -8.601209136, -8.601209136, -8.696662315, -9.625735021, -9.956786262, -8.76148359,
          -11.07905397, -12.2184875, -13.18758763, -8.096683018, -9.244530386, -7.14442691, -8.297382846, -6.946486306,
          -9.665762445, -9.244530386, -9.03089987, -8.068754016, -9.507819773, -9.20818754, -9.665762445, -11.02372909,
          -10.96910013, -12.36572006, -10.96910013, -11.93820026, -9.871627753, -10.08773924, -8.96196279, -9.469215565,
          -9.507819773, -9.625735021, -10.91514981, -12.2184875, -9.746941347, -11.19186408, -10.17728767, -10.31517051,
          -9.430951487, -10.17728767, -9.546770212, -9.871627753, -10.40958608, -7.670038896, -8.326826653,
          -9.355420108, -8.477116556, -9.546770212, -8.632794328, -9.136401693, -10.50609993, -12.00659451,
          -13.18758763, -10.86186148, -11.02372909, -10.55517328, -10, -8.446639625, -9.355420108, -9.956786262,
          -10.80921908, -10.91514981, -11.61150909, -10.36212173, -12.6760624, -12.6760624, -8.446639625, -9.172146297,
          -9.788107009, -9.829666607, -10.45757491, -9.281179927, -10.17728767, -8.894102897, -8.927900304,
          -9.546770212, -10.13228266, -10.70581074, -10.70581074, -11.67491087, -12.51811973, -10.75720714,
          -10.50609993, -10.80921908, -11.61150909, -10.04364805, -10.80921908, -8.386319978, -9.706162223,
          -9.871627753, -8.664610916, -8.068754016, -7.033348097, -8.181564121, -8.76148359, -9.788107009, -11.07905397,
          -11.42667504, -9.871627753, -10.17728767, -10.86186148, -11.3076828, -9.956786262, -9.829666607, -10.36212173,
          -8.326826653, -8.446639625, -9.746941347, -7.644715531, -8.01342913, -8.927900304, -9.871627753, -9.586073148,
          -10.70581074, -8.068754016, -8.632794328, -9.586073148, -10.86186148, -11.19186408, -12.51811973,
          -8.507808873, -8.894102897, -9.546770212, -10.96910013, -11.3076828, -9.913998282, -11.3667714, -11.42667504,
          -9.956786262, -8.446639625, -9.507819773, -9.318141383, -10.31517051, -9.871627753, -9.788107009,
          -11.13509275, -13.27902142, -5.436339669, -5.833594927, -4.841261563, -6.32644079, -7.544873322, -7.121982701,
          -7.39928612, -8.696662315, -10.04364805, -10.50609993, -10.70581074, -11.73925197, -9.913998282, -10.80921908,
          -12.29147988, -12.83996656, -10.86186148, -12.2184875, -8.416375079, -9.586073148, -10.80921908, -10.75720714,
          -9.746941347, -5.783960731, -7.594507517, -8.068754016, -9.03089987, -10.04364805, -9.913998282, -8.794260688,
          -8.297382846, -6.090648929, -7.328282716, -8.728952016, -9.244530386, -9.393021596, -10.36212173,
          -11.07905397, -10.13228266, -6.556077263, -7.825160558, -9.03089987, -9.03089987, -10.45757491, -11.24938737,
          -12.07608311, -12.14670165, -10.80921908, -9.746941347, -10.08773924, -10.50609993, -10.70581074,
          -12.14670165, -11.93820026, -12.14670165, -10.55517328, -11.67491087, -11.13509275, -10.75720714,
          -11.48741651, -12.92429824, -13.46787486, -11.67491087, -12.36572006, -13.56547324, -12.51811973,
          -10.04364805, -7.772835289, -9.03089987, -10.70581074, -9.393021596, -10.50609993, -10.13228266, -9.746941347,
          -9.829666607, -11.13509275, -10.08773924, -11.3076828, -11.5490196, -12.6760624, -11.93820026, -12.51811973,
          -10.50609993, -11.02372909, -7.619538969, -8.728952016, -9.788107009, -9.355420108, -8.664610916,
          -9.788107009, -11.93820026, -9.586073148, -10.60480747, -11.42667504, -10.08773924, -10.91514981,
          -8.386319978, -9.136401693, -7.35182177, -9.065783148, -9.430951487, -10.60480747, -7.904849855, -9.244530386,
          -10.45757491, -7.569619513, -8.827287043, -9.956786262, -10.04364805, -10.13228266, -8.860566477,
          -9.100948886, -10.55517328, -11.67491087, -10.91514981, -11.3667714, -7.93174124, -7.619538969, -7.772835289,
          -8.894102897, -8.210230527, -6.968039426, -8.01342913, -8.096683018, -9.393021596, -10.13228266, -9.625735021,
          -9.281179927, -10.65501549, -10.65501549, -10.22276395, -11.19186408, -11.67491087, -11.93820026,
          -13.66531544, -14.8148606, -14.94850022, -14.8148606, -11.67491087, -11.3076828, -10.91514981, -12.14670165,
          -12.2184875, -9.03089987, -10.22276395, -9.625735021, -9.136401693, -10.31517051, -9.788107009, -10.40958608,
          -11.19186408, -8.827287043, -9.20818754, -9.871627753, -10.13228266, -10.96910013, -12.2184875, -6.615435064,
          -7.544873322, -7.878123956, -6.16184634, -7.619538969, -8.268137316, -9.355420108, -6.736641391, -6.363880201,
          -7.21246399, -6.989700043, -5.590909179, -5.559552041, -6.777807053, -6.458915609, -5.346171486, -5.421181033,
          -6.038006529, -6.925039621, -8.096683018, -6.038006529, -3.736596326, -3.233063904, -2.471835688,
          -3.840499483, -2.533658011, -3.788237182, -1.567672219, -2.153827074, -3.51639989, -4.50996738, -5.934598196,
          -6.16184634, -6.695862267, -7.79891912, -5.85026652, -6.777807053, -4.12289035, -6.179829574, -1.157712304,
          -2.533658011, -1.681302257, -2.564902353, -3.85102784, -4.424927981, -5.88380294, -5.243288117, -4.034029044,
          -3.79863945, -3.946949539, -3.968556274, -2.464169411, -3.251388593, -3.59518563, -4.412914295, -1.904402854,
          -3.34419009, -4.710832997, -5.316526696, -3.914739664, -5.030703519, -4.894549898, -3.429441471, 0.557604647,
          -0.856568429, 0.043213738, -1.414628024, -1.797985405, -1.9859629, 2.516382204, 1.277525158, 0.386201619,
          -0.043648054, -0.877779435, -1.904402854, -2.41845378, -3.635121036, -2.549252084, -4.424927981, -5.670307091,
          -1.706962272, -2.90730039, -2.069083998, -3.242216583, -1.331221857, -1.209041205, -0.893755951, -2.006594505,
          -3.080348972, -2.388241868, 0.43362278, -1.007268127, -1.313555616, -1.255181823, -1.944991418, -0.45275209,
          -1.067932469, -0.414361168, 0.244856677, -1.152046361, 0.881360887, 1.370374548, -0.048037084, -1.348960254,
          0.982975365, 2.417954313, 3.115419584, 2.166935992, 2.410481507, 1.498346967, 0.253058653, 0.79181246,
          -0.560111249, -1.481303993, -1.630432629, -2.975694636, -2.182446253, -1.630432629, -2.898826349,
          -3.325470471, -4.424927981, -4.12289035, -1.791420106, -3.21481621, -3.269790929, -1.573907604, -0.186344909,
          1.482940974, 0.17867719, -1.084625423, -2.276782933, -3.526170299, -3.914739664, -2.949920407, -3.448615652,
          0.073209529, -0.985416786, -1.152046361, -1.778319206, -1.118205061, -1.444808443, 1.048284037, 0.729847446,
          -0.462403083, -1.745738822, -3.071530807, -2.76544328, -3.645162532, -3.675427078, -4.317982759, 0.136796973,
          -1.112590393, -2.32102384, -1.611509093, 0.111473608, -1.884249941, -2.21125528, -2.848326422, -1.284270645,
          -2.196826879, -2.620126737, 1.199154103, 0.480531731, -0.496351456, -1.313555616, -2.541448048, -2.572748687,
          -1.084625423, 0.253058653, 0.297894708, -0.352690789, -1.561445774, -2.395775166, -0.609802236, -1.752235375,
          -3.089185079, -2.426039712, -3.61510743, -2.72458743, -3.496924769, -3.053948011, -1.378686207, -2.636034977,
          0.484418036, -0.550240916, -1.687703061, -2.596373105, 1.251558296, 0.972573097, -0.381045263, -1.51810883,
          -2.269453066, -3.316140833, -1.319436382, -1.511952989, -2.132485779, -1.89767482, -0.530567293, 1.126050015,
          -0.017406616, -0.716041477, -1.739251973, -2.240256689, -2.708352103, -2.441251443, -2.814983111,
          -3.872161433, -3.809066694, -4.841261563, -3.68556231, -3.68556231, -4.723700991, -3.74687549, -4.12289035,
          -5.100415206, -5.36107011, -6.179829574, -7.544873322, -4.449055514, -4.353339357, -3.946949539, -5.257837359,
          -5.171264164, -5.559552041, -6.675615401, -6.42065153, -3.788237182, -4.841261563, -6.216020991, -6.861327796,
          -5.606673062, -2.73272791, -0.952844547, -1.958605677, -3.288271573, -4.894549898, -3.080348972, -4.473317839,
          -4.659738939, -3.260580014, -4.08935393, -6.38272164, -6.179829574, -5.85026652, -7.235381958, -5.751183634,
          -3.381873145, -5.391021572, -6.234230429, -5.88380294, -6.003262785, -4.710832997, -5.734887386, -6.716203966,
          -7.986028757, 0.021660618, -0.736575534, -0.109953843, -1.237821594, -2.620126737, -3.68556231, -3.362990746,
          -4.341521813, -5.751183634, -4.388986164, -3.251388593, -2.388241868, -3.716110699, -3.325470471,
          -4.353339357, 1.482940974, 1.095785469, -1.348960254, -1.487416513, -2.51811973, -3.946949539, -5.346171486,
          -5.85026652, -6.25251654, -7.544873322, -8.326826653, -7.958800173, -6.51695137, -7.423214251, -7.121982701,
          -8.538719643, -9.956786262, -0.515870342, -1.598939055, -3.655227298, -5.003129174, -6.143937264,
          -7.423214251, -7.878123956, -7.85156152, -8.927900304, -6.716203966, -6.716203966, -7.281583935, -6.055483192,
          -6.736641391, -6.073030467, -5.900668767, -6.345120151, -5.88380294, -7.21246399, -6.635402662, 0.644579892,
          0.678145112, -0.419141515, -1.636758843, -3.39134522, -0.974532207, -1.817741064, -1.965428844, -1.636758843,
          -2.700257143, -2.865094569, -2.949920407, -4.202164034, -4.867823999, -5.985994592, -6.556077263,
          -5.331323796, -4.179366371, -4.388986164, -4.294570601, -5.05845406, -4.88116639, -2.82329497, -3.526170299,
          -4.341521813, -5.044556625, -4.06713933, -5.07239611, -6.32644079, -7.189666328, -7.14442691, -6.716203966,
          -8.268137316, -8.153085692, -9.03089987, -8.124792792, -7.423214251, -8.860566477, -8.507808873, -8.124792792,
          -8.210230527, -9.393021596, -10.22276395, -10.96910013, -10.22276395, -8.416375079, -9.393021596, -7.79891912,
          -9.065783148, -9.065783148, -9.065783148, -7.746907183, -8.601209136, -6.055483192, -7.47146969, -6.478174819,
          -6.757175447, -7.746907183, -6.42065153, -7.85156152, -6.675615401, -6.777807053, -2.975694636, -3.635121036,
          -4.814860601, -5.272435507, -6.716203966, -7.93174124, -8.446639625, -7.746907183, -4.202164034, -4.534573365,
          -5.07239611, -5.88380294, -7.14442691, -7.986028757, -7.520267336, -8.860566477, -9.913998282, -6.861327796,
          -6.840296545, -7.495799977, -9.788107009, -9.355420108, -6.575773192, -7.39928612, -8.728952016, -8.927900304,
          -8.538719643, -7.878123956, -8.181564121, -7.055337738, -4.08935393, -4.9757288, -4.68521083, -5.171264164,
          -6.038006529, -6.595558852, -5.934598196, -7.166987713, -8.507808873, -9.913998282, -10.31517051,
          -10.86186148, -12.59637311, -11.67491087, -12.59637311, -11.3667714, -7.904849855, -8.326826653, -9.20818754,
          -7.077439286, -7.958800173, -8.181564121, -8.239087409, -7.958800173, -9.244530386, -8.894102897,
          -8.569851997, -9.956786262, -11.3667714, -10.75720714, -11.80456064, -12.83996656, -10.31517051, -8.728952016,
          -11.24938737, -7.544873322, -7.235381958, -7.447274949, -8.297382846, -9.469215565, -7.520267336, -7.85156152,
          -7.986028757, -9.065783148, -10.22276395, -11.07905397, -10.22276395, -8.210230527, -9.393021596,
          -9.871627753, -9.318141383, -10, -10.45757491, -10.86186148, -8.894102897, -7.772835289, -8.601209136,
          -9.469215565, -8.827287043, -8.860566477, -8.96196279, -9.430951487, -10.55517328, -10.91514981, -10.31517051,
          -9.355420108, -10.40958608, -10.36212173, -11.3076828, -9.20818754, -7.569619513, -7.619538969, -8.569851997,
          -9.956786262, -8.601209136, -7.746907183, -8.569851997, -8.268137316, -9.318141383, -10.22276395,
          -9.788107009, -10.80921908, -10.65501549, -8.268137316, -8.894102897, -9.871627753, -5.800442515,
          -6.882461389, -7.375489103, -8.996294549, -7.423214251, -8.239087409, -7.695510786, -8.153085692, -7.93174124,
          -9.281179927, -10.13228266, -8.601209136, -10, -10.96910013, -11.3076828, -10.86186148, -7.904849855,
          -8.76148359, -8.860566477, -7.033348097, -5.287082889, -6.675615401, -6.020599913, -7.077439286, -6.736641391,
          -7.21246399, -7.14442691, -7.986028757, -7.904849855, -7.986028757, -8.794260688, -9.706162223, -10.13228266,
          -10.50609993, -10.75720714, -10.45757491, -9.507819773, -8.416375079, -9.706162223, -10.96910013,
          -11.87086643, -10.04364805, -10.26872146, -12.00659451, -9.393021596, -10.40958608, -9.507819773,
          -8.326826653, -7.644715531, -8.210230527, -5.214335044, -6.615435064, -7.825160558, -8.041003476,
          -5.686362358, -6.497519817, -7.055337738, -8.239087409, -9.100948886, -8.124792792, -9.355420108,
          -7.328282716, -8.96196279, -9.829666607, -9.244530386, -9.507819773, -9.871627753, -10.91514981, -7.14442691,
          -8.996294549, -9.281179927, -9.871627753, -10.04364805, -10.75720714, -10, -7.958800173, -8.76148359,
          -8.96196279, -8.860566477, -10.26872146, -10.65501549, -9.507819773, -10.75720714, -10.65501549, -11.5490196,
          -11.73925197, -9.281179927, -6.695862267, -7.79891912, -7.721132954, -8.927900304, -9.469215565, -8.326826653,
          -7.85156152, -8.477116556, -7.670038896, -7.721132954, -7.644715531, -7.958800173, -7.746907183, -6.882461389,
          -7.825160558, -8.297382846, -2.790142558, -3.716110699, -6.42065153, -6.903698326, -6.073030467, -6.757175447,
          -8.041003476, -9.469215565, -8.664610916, -9.244530386, -9.065783148, -9.706162223, -8.326826653,
          -7.166987713, -9.20818754, -9.100948886, -9.625735021, -11.02372909, -12.44125144, -9.665762445, -11.87086643,
          -9.03089987, -9.546770212, -9.100948886, -8.096683018, -7.235381958, -7.304870558, -7.644715531, -6.968039426,
          -6.038006529, -6.989700043, -8.416375079, -6.989700043, -2.433638918, -3.675427078, -4.16801226, -4.762535332,
          -6.038006529, -6.925039621, -8.386319978, -9.625735021, -8.326826653, -6.575773192, -8.01342913, -7.569619513,
          -4.621809049, -5.157001607, -4.828041021, -3.946949539, -4.06713933, -5.171264164, -6.497519817, -7.281583935,
          -8.416375079, -7.39928612, -8.096683018, -7.986028757, -6.363880201, -6.989700043, -7.986028757, -8.664610916,
          -9.03089987, -9.065783148, -8.124792792, -8.096683018, -7.520267336, -8.096683018, -6.882461389, -6.16184634,
          -7.35182177, -8.632794328, -8.794260688, -9.706162223, -8.268137316, -8.477116556, -9.281179927, -7.520267336,
          -8.153085692, -10, -8.268137316, -8.601209136, -4.40093375, -5.734887386, -6.798537139, -7.35182177,
          -9.871627753, -9.586073148, -8.601209136, -6.882461389, -6.968039426, -8.096683018, -8.507808873,
          -7.375489103, -8.569851997, -8.416375079, -7.21246399, -7.166987713, -8.794260688, -4.659738939, -5.968794788,
          -7.375489103, -6.882461389, -7.39928612, -5.968794788, -6.81936665, -8.181564121, -7.258421507, -4.12289035,
          -5.316526696, -5.783960731, -6.615435064, -5.65431096, -6.143937264, -4.534573365, -5.36107011, -6.736641391,
          -5.287082889, -7.904849855, -7.47146969, -8.827287043, -8.477116556, -9.172146297, -9.625735021, -10.13228266,
          -9.913998282, -11.19186408, -6.363880201, -5.497508917, -6.882461389, -7.986028757, -6.536470255,
          -7.544873322, -7.544873322, -1.157712304, -3.79863945, -2.865094569, -4.134126953, -5.044556625, -5.376020021,
          -6.861327796, -7.958800173, -7.644715531, -9.03089987, -10.17728767, -10.40958608, -11.42667504, -12.59637311,
          -6.073030467, -4.921441283, -2.08309351, -2.502636844, -3.605135107, -4.473317839, -5.4515514, -6.716203966,
          -5.783960731, -6.090648929, -7.099653886, -7.077439286, -8.181564121, -9.546770212, -7.544873322,
          -8.124792792, -7.878123956, -6.882461389, -7.93174124, -7.644715531, -7.304870558, -7.79891912, -8.664610916,
          -7.878123956, -5.900668767, -5.543957967, -6.003262785, -7.746907183, -8.860566477, -9.100948886,
          -9.586073148, -9.913998282, -10.65501549, -11.93820026, -9.136401693, -9.665762445, -7.904849855,
          -5.575202309, -6.126101737, -7.055337738, -7.569619513, -7.520267336, -8.860566477, -9.318141383,
          -9.355420108, -10.04364805, -9.586073148, -9.100948886, -8.860566477, -8.507808873, -7.281583935, -8.76148359,
          -8.569851997, -5.590909179, -0.017406616, 0.030294706, -1.408617027, -2.328441339, -3.448615652, -4.854522473,
          -6.289321377, -7.235381958, -8.507808873, -9.625735021, -7.958800173, -8.601209136, -8.068754016,
          -9.507819773, -8.728952016, -9.956786262]
    sg = [-6.655462488, -7.93174124, -7.47146969, -8.76148359, -8.996294549, -8.297382846, -8.76148359, -10,
          -8.507808873, -8.728952016, -9.172146297, -9.829666607, -10.60480747, -10.17728767, -8.096683018,
          -8.728952016, -9.665762445, -4.294570601, -5.606673062, -6.38272164, -7.121982701, -8.538719643, -8.041003476,
          -7.670038896, -8.507808873, -7.904849855, -8.76148359, -6.38272164, -6.42065153, -8.696662315, -9.871627753,
          -10.40958608, -9.829666607, -8.356471442, -9.136401693, -9.546770212, -10.36212173, -11.48741651,
          -10.80921908, -10.91514981, -11.3076828, -7.35182177, -8.664610916, -9.788107009, -8.210230527, -8.664610916,
          -10.08773924, -9.956786262, -8.477116556, -5.421181033, -6.27087997, -7.235381958, -7.21246399, -6.27087997,
          -6.695862267, -4.828041021, -4.341521813, -5.214335044, -6.401645177, -7.121982701, -7.721132954,
          -7.772835289, -6.478174819, -7.772835289, -7.746907183, -9.172146297, -8.01342913, -8.860566477, -9.393021596,
          -8.860566477, -7.721132954, -8.927900304, -9.507819773, -10.80921908, -6.108339156, -5.287082889,
          -6.478174819, -7.423214251, -7.077439286, -9.430951487, -10.04364805, -10.86186148, -11.13509275, -9.03089987,
          -9.829666607, -4.190750243, -5.421181033, -5.751183634, -6.25251654, -7.304870558, -6.439741428, -8.041003476,
          -9.355420108, -6.635402662, -7.077439286, -6.615435064, -5.482135645, -5.528419687, -6.51695137, -4.962093169,
          -5.833594927, -4.762535332, -4.74955193, -3.142582614, -3.829996589, -4.723700991, -6.655462488, -8.041003476,
          -9.065783148, -10.31517051, -11.61150909, -10.75720714, -6.25251654, -4.723700991, -4.921441283, -6.126101737,
          -7.121982701, -7.825160558, -6.989700043, -8.268137316, -8.569851997, -9.546770212, -9.430951487, -7.47146969,
          -8.268137316, -9.706162223, -10.13228266, -7.447274949, -6.861327796, -4.854522473, -6.073030467, -7.21246399,
          -9.100948886, -8.068754016, -7.21246399, -8.268137316, -7.619538969, -7.825160558, -7.85156152, -6.695862267,
          -6.925039621, -7.011469236, -7.619538969, -8.996294549, -7.520267336, -5.36107011, -6.716203966, -6.020599913,
          -5.670307091, -6.536470255, -4.609239012, -5.436339669, -6.51695137, -7.35182177, -8.416375079, -7.670038896,
          -8.416375079, -9.172146297, -10, -10.36212173, -8.538719643, -6.363880201, -7.447274949, -8.728952016,
          -9.871627753, -6.615435064, -7.258421507, -7.569619513, -8.827287043, -4.801720062, -3.69572125, -4.775557665,
          -5.88380294, -4.497716469, -5.257837359, -5.171264164, -6.497519817, -6.635402662, -7.772835289, -6.234230429,
          -5.376020021, -5.406075122, -6.556077263, -8.446639625, -7.121982701, -8.538719643, -9.788107009, -7.39928612,
          -6.439741428, -8.268137316, -7.85156152, -8.894102897, -9.244530386, -9.507819773, -10.13228266, -11.5490196,
          -9.871627753, -11.3667714, -9.430951487, -10.26872146, -9.100948886, -9.913998282, -7.544873322, -5.171264164,
          -6.090648929, -7.166987713, -5.867002359, -4.473317839, -3.51639989, -4.225082002, -5.316526696, -6.615435064,
          -5.686362358, -6.32644079, -7.375489103, -8.794260688, -4.225082002, -5.331323796, -5.985994592, -6.497519817,
          -4.659738939, -5.800442515, -6.882461389, -7.85156152, -8.664610916, -4.841261563, -5.767541261, -3.809066694,
          -4.034029044, -5.331323796, -7.35182177, -6.536470255, -6.575773192, -5.63837353, -7.077439286, -7.594507517,
          -6.497519817, -6.81936665, -6.840296545, -6.556077263, -7.21246399, -7.304870558, -8.068754016, -7.721132954,
          -8.326826653, -6.757175447, -5.88380294, -6.840296545, -5.331323796, -5.622494372, -6.575773192, -4.762535332,
          -5.331323796, -6.635402662, -7.986028757, -6.777807053, -6.38272164, -7.121982701, -6.798537139, -5.800442515,
          -6.861327796, -5.71865206, -7.055337738, -5.543957967, -6.946486306, -7.14442691, -7.258421507, -8.477116556,
          -8.794260688, -10.26872146, -7.772835289, -7.958800173, -7.644715531, -8.996294549, -8.827287043, -9.20818754,
          -8.356471442, -8.827287043, -9.244530386, -9.586073148, -9.100948886, -8.632794328, -8.507808873,
          -8.696662315, -9.546770212, -9.393021596, -10.45757491, -9.586073148, -8.996294549, -10.40958608,
          -11.61150909, -11.5490196, -11.80456064, -8.827287043, -10.04364805, -10.70581074, -10.60480747, -11.5490196,
          -8.153085692, -9.355420108, -7.986028757, -8.538719643, -9.136401693, -7.986028757, -7.594507517,
          -7.670038896, -3.59518563, -5.016894462, -5.559552041, -5.85026652, -5.030703519, -3.506651413, -5.157001607,
          -6.090648929, -6.635402662, -7.520267336, -7.569619513, -6.655462488, -7.878123956, -8.728952016,
          -9.172146297, -6.903698326, -5.214335044, -3.325470471, -3.61510743, -3.979400087, -4.867823999, -6.234230429,
          -6.556077263, -7.746907183, -9.03089987, -10.31517051, -10.17728767, -10.70581074, -8.860566477, -7.47146969,
          -9.586073148, -8.153085692, -9.281179927, -9.20818754, -10.50609993, -9.871627753, -10.70581074, -11.87086643,
          -12.36572006, -8.894102897, -8.96196279, -8.569851997, -8.927900304, -8.041003476, -7.258421507, -8.181564121,
          -8.356471442, -9.829666607, -8.538719643, -8.96196279, -8.446639625, -6.108339156, -6.25251654, -7.189666328,
          -8.477116556, -7.375489103, -8.416375079, -8.96196279, -5.686362358, -5.575202309, -5.867002359, -5.228787453,
          -6.345120151, -7.958800173, -5.4668166, -6.363880201, -6.736641391, -7.85156152, -9.100948886, -10.36212173,
          -10.60480747, -10.96910013, -10.96910013, -11.80456064, -8.096683018, -5.85026652, -6.946486306, -7.958800173,
          -7.569619513, -8.416375079, -8.569851997, -10.40958608, -6.675615401, -8.096683018, -9.546770212,
          -9.586073148, -8.356471442, -7.033348097, -5.044556625, -5.7024772, -5.734887386, -5.575202309, -6.38272164,
          -6.798537139, -7.772835289, -8.356471442, -8.356471442, -8.239087409, -6.289321377, -6.345120151,
          -7.695510786, -8.210230527, -8.268137316, -7.93174124, -8.996294549, -10.91514981, -9.829666607, -10.96910013,
          -12.00659451, -12.36572006, -9.788107009, -8.068754016, -7.93174124, -8.696662315, -8.728952016, -7.93174124,
          -7.011469236, -6.51695137, -5.985994592, -6.989700043, -6.090648929, -6.289321377, -7.495799977, -7.79891912,
          -6.536470255, -7.878123956, -5.590909179, -6.575773192, -6.695862267, -6.595558852, -7.423214251, -6.27087997,
          -6.345120151, -7.21246399, -5.800442515, -7.304870558, -5.30177984, -5.421181033, -5.482135645, -6.234230429,
          -6.345120151, -5.734887386, -8.096683018, -9.546770212, -8.927900304, -6.536470255, -6.946486306,
          -6.179829574, -5.734887386, -6.736641391, -7.772835289, -7.39928612, -7.166987713, -9.913998282, -11.3667714,
          -11.3076828, -7.619538969, -7.619538969, -7.281583935, -6.968039426, -8.068754016, -9.172146297, -7.619538969,
          -7.033348097, -7.520267336, -8.894102897, -9.172146297, -8.569851997, -8.068754016, -8.664610916,
          -8.538719643, -5.100415206, -6.055483192, -4.801720062, -6.946486306, -7.39928612, -7.39928612, -8.181564121,
          -7.904849855, -6.81936665, -7.986028757, -6.51695137, -7.39928612, -8.181564121, -6.615435064, -7.35182177,
          -8.507808873, -9.746941347, -8.827287043, -9.788107009, -8.268137316, -8.181564121, -8.210230527,
          -8.860566477, -10.86186148, -11.3667714, -11.3076828, -11.48741651, -12.92429824, -13.37242168, -12.59637311,
          -13.0980392, -13.0980392, -7.304870558, -6.363880201, -5.114492835, -6.32644079, -7.099653886, -7.79891912,
          -9.065783148, -9.586073148, -9.469215565, -10.22276395, -9.546770212, -7.619538969, -7.304870558,
          -4.056074496, -5.030703519, -6.25251654, -7.281583935, -5.528419687, -6.595558852, -7.544873322, -6.25251654,
          -6.439741428, -5.63837353, -6.716203966, -7.423214251, -8.326826653, -9.706162223, -11.07905397, -11.73925197,
          -9.829666607, -9.546770212, -10.70581074, -7.121982701, -8.356471442, -8.507808873, -7.35182177, -7.958800173,
          -8.632794328, -7.986028757, -8.632794328, -9.956786262, -8.696662315, -9.788107009, -10.36212173,
          -8.696662315, -6.25251654, -6.716203966, -8.041003476, -8.601209136, -5.985994592, -5.406075122, -5.543957967,
          -5.833594927, -4.353339357, -5.63837353, -6.798537139, -6.307841426, -5.346171486, -3.946949539, -5.171264164,
          -5.867002359, -6.16184634, -6.777807053, -8.210230527, -9.665762445, -9.586073148, -5.36107011, -5.985994592,
          -7.375489103, -6.42065153, -7.055337738, -6.003262785, -7.35182177, -8.728952016, -6.536470255, -7.986028757,
          -9.318141383, -9.507819773, -8.356471442, -7.055337738, -4.775557665, -3.925449768, -4.534573365,
          -5.900668767, -6.126101737, -6.675615401, -4.248121551, -4.596705252, -5.4668166, -6.655462488, -8.297382846,
          -8.927900304, -9.788107009, -8.326826653, -5.528419687, -7.099653886, -6.716203966, -6.345120151, -7.21246399,
          -8.068754016, -8.297382846, -8.664610916, -9.746941347, -10.91514981, -11.42667504, -10.80921908,
          -6.635402662, -5.030703519, -6.478174819, -7.495799977, -7.878123956, -6.925039621, -7.85156152, -8.632794328,
          -5.606673062, -6.81936665, -7.304870558, -5.376020021, -6.216020991, -7.619538969, -6.798537139, -5.590909179,
          -6.27087997, -7.619538969, -8.210230527, -8.76148359, -8.326826653, -7.281583935, -8.210230527, -9.244530386,
          -7.772835289, -10.17728767, -8.297382846, -7.695510786, -8.268137316, -7.670038896, -9.03089987, -10.17728767,
          -11.87086643, -8.210230527, -7.619538969, -8.096683018, -10.17728767, -7.825160558, -9.065783148,
          -9.913998282, -9.430951487, -10.17728767, -8.632794328, -6.925039621, -7.495799977, -7.47146969, -7.93174124,
          -7.986028757, -7.569619513, -8.894102897, -5.4668166, -6.16184634, -7.077439286, -7.594507517, -6.695862267,
          -8.124792792, -8.632794328, -9.746941347, -10.86186148, -10.80921908, -7.328282716, -8.632794328, -11.3667714,
          -7.423214251, -8.664610916, -7.721132954, -9.746941347, -7.166987713, -7.772835289, -6.925039621,
          -5.686362358, -5.543957967, -6.556077263, -7.099653886, -8.356471442, -8.446639625, -8.356471442,
          -8.446639625, -8.297382846, -8.827287043, -9.913998282, -10.86186148, -11.02372909, -7.569619513, -7.39928612,
          -5.346171486, -7.825160558, -9.100948886, -9.665762445, -10.55517328, -8.326826653, -7.375489103,
          -7.772835289, -8.827287043, -8.794260688, -9.507819773, -9.355420108, -8.696662315, -5.128616245, -5.85026652,
          -6.989700043, -6.478174819, -6.42065153, -6.595558852, -5.185573715, -6.478174819, -6.757175447, -9.430951487,
          -7.721132954, -8.239087409, -9.318141383, -10.40958608, -11.61150909, -10, -10.96910013, -10.31517051,
          -10.80921908, -10, -6.861327796, -6.345120151, -7.520267336, -8.507808873, -8.996294549, -6.757175447,
          -4.68521083, -5.767541261, -6.968039426, -8.181564121, -9.546770212, -8.507808873, -8.827287043, -8.696662315,
          -7.121982701, -6.903698326, -5.63837353, -5.4515514, -6.497519817, -7.520267336, -5.272435507, -5.228787453,
          -6.090648929, -6.556077263, -7.904849855, -6.903698326, -3.575354798, -4.736607226, -4.145392705,
          -4.801720062, -5.331323796, -4.306260904, -4.841261563, -6.497519817, -7.721132954, -8.728952016,
          -6.989700043, -8.239087409, -6.81936665, -6.42065153, -7.47146969, -7.594507517, -5.05845406, -5.214335044,
          -3.925449768, -3.260580014, -4.596705252, -5.867002359, -6.25251654, -4.546928835, -4.584207561, -4.57174573,
          -5.391021572, -5.816987087, -6.090648929, -5.7024772, -7.520267336, -6.861327796, -7.121982701, -8.386319978,
          -8.569851997, -10, -8.76148359, -9.665762445, -11.02372909, -7.825160558, -8.827287043, -6.81936665,
          -6.989700043, -9.625735021, -8.446639625, -9.788107009, -8.894102897, -10.08773924, -8.181564121,
          -9.281179927, -9.586073148, -7.21246399, -8.153085692, -5.05845406, -6.968039426, -8.124792792, -9.430951487,
          -9.172146297, -10.45757491, -7.520267336, -8.860566477, -9.956786262, -9.788107009, -6.458915609,
          -7.619538969, -8.239087409, -9.281179927, -8.297382846, -9.100948886, -7.520267336, -7.825160558,
          -6.536470255, -6.363880201, -5.528419687, -4.854522473, -6.073030467, -6.595558852, -6.903698326,
          -8.664610916, -8.416375079, -9.871627753, -10.08773924, -8.268137316, -7.39928612, -7.85156152, -6.307841426,
          -5.63837353, -6.234230429, -6.38272164, -7.825160558, -8.446639625, -9.871627753, -8.181564121, -8.538719643,
          -9.546770212, -8.297382846, -8.01342913, -7.189666328, -7.904849855, -6.840296545, -7.077439286, -8.477116556,
          -8.210230527, -8.894102897, -7.878123956, -8.696662315, -8.728952016, -7.281583935, -6.497519817,
          -6.020599913, -7.47146969, -7.878123956, -6.989700043, -7.189666328, -6.25251654, -6.197887583, -6.038006529,
          -7.14442691, -7.258421507, -8.153085692, -7.281583935, -7.878123956, -8.696662315, -9.913998282, -10.26872146,
          -10.86186148, -10.08773924, -9.956786262, -4.948500217, -4.710832997, -5.157001607, -7.189666328,
          -8.446639625, -6.497519817, -7.35182177, -7.772835289, -6.615435064, -7.721132954, -7.85156152, -8.326826653,
          -8.569851997, -8.268137316, -6.108339156, -7.569619513, -8.894102897, -7.772835289, -6.925039621,
          -8.239087409, -9.03089987, -8.894102897, -9.546770212, -8.894102897, -7.825160558, -6.439741428, -7.14442691,
          -7.594507517, -5.934598196, -7.878123956, -9.065783148, -7.166987713, -7.375489103, -7.85156152, -9.065783148,
          -5.670307091, -5.767541261, -3.410351573, -3.306831194, -4.634415574, -5.590909179, -6.615435064,
          -7.569619513, -8.601209136, -9.065783148, -8.297382846, -8.297382846, -8.728952016, -8.860566477,
          -9.586073148, -9.586073148, -10.40958608, -11.5490196, -11.19186408, -10.13228266, -10.75720714, -7.304870558,
          -8.569851997, -9.318141383, -8.894102897, -9.393021596, -10.17728767, -10.26872146, -10.80921908,
          -9.546770212, -6.16184634, -6.840296545, -7.79891912, -7.35182177, -8.096683018, -9.393021596, -8.76148359,
          -7.569619513, -6.439741428, -4.989407378, -5.900668767, -7.099653886, -4.828041021, -4.74955193, -6.497519817,
          -6.777807053, -7.166987713, -7.39928612, -7.772835289, -7.79891912, -9.065783148, -9.913998282, -10.36212173,
          -11.67491087, -8.794260688, -9.956786262, -10.65501549, -10.04364805, -10.70581074, -8.068754016,
          -8.297382846, -8.477116556, -6.020599913, -8.601209136, -10, -9.913998282, -11.02372909, -12.00659451,
          -11.42667504, -9.625735021, -10.55517328, -8.996294549, -4.48550002, -5.7024772, -6.903698326, -7.958800173,
          -8.696662315, -10.08773924, -10.08773924, -6.216020991, -7.14442691, -8.386319978, -7.986028757, -7.986028757,
          -7.14442691, -6.861327796, -7.375489103, -6.216020991, -6.126101737, -7.47146969, -7.85156152, -8.096683018,
          -8.153085692, -8.927900304, -7.695510786, -8.728952016, -8.894102897, -9.355420108, -5.05845406, -5.867002359,
          -7.011469236, -6.575773192, -7.495799977, -7.878123956, -7.495799977, -7.594507517, -5.185573715,
          -6.055483192, -6.575773192, -7.721132954, -6.25251654, -6.38272164, -7.695510786, -4.934949676, -4.801720062,
          -6.401645177, -6.946486306, -7.099653886, -8.096683018, -8.477116556, -9.244530386, -8.416375079,
          -6.861327796, -5.783960731, -7.077439286, -8.386319978, -6.861327796, -6.840296545, -6.575773192,
          -7.099653886, -8.477116556, -9.546770212, -10.50609993, -4.412914295, -5.543957967, -6.307841426,
          -6.695862267, -6.946486306, -5.951662834, -6.882461389, -6.51695137, -6.655462488, -6.757175447, -6.38272164,
          -5.867002359, -7.099653886, -4.621809049, -4.775557665, -5.346171486, -6.020599913, -7.166987713,
          -9.355420108, -7.544873322, -9.829666607, -8.894102897, -9.788107009, -9.172146297, -4.48550002, -5.228787453,
          -5.867002359, -6.615435064, -5.985994592, -7.055337738, -8.239087409, -9.913998282, -10.50609993,
          -9.546770212, -10.91514981, -7.569619513, -7.644715531, -6.126101737, -7.055337738, -7.825160558, -6.42065153,
          -7.14442691, -7.189666328, -8.268137316, -9.172146297, -10.17728767, -11.19186408, -9.393021596, -10.70581074,
          -9.913998282, -11.07905397, -5.543957967, -5.100415206, -6.197887583, -6.716203966, -8.096683018,
          -8.927900304, -10.17728767, -8.76148359, -9.172146297, -9.546770212, -8.632794328, -5.85026652, -5.670307091,
          -5.71865206, -6.81936665, -7.746907183, -7.644715531, -7.569619513, -8.041003476, -7.495799977, -6.757175447,
          -6.81936665, -7.077439286, -7.569619513, -7.825160558, -9.065783148, -8.827287043, -7.772835289, -8.927900304,
          -8.794260688, -9.625735021, -8.664610916, -6.655462488, -5.65431096, -7.055337738, -7.594507517, -6.575773192,
          -7.825160558, -7.011469236, -8.477116556, -7.235381958, -8.356471442, -9.546770212, -7.520267336, -9.03089987,
          -7.594507517, -8.041003476, -4.854522473, -5.951662834, -6.536470255, -6.289321377, -6.882461389,
          -7.258421507, -6.307841426, -6.757175447, -7.670038896, -8.860566477, -8.96196279, -10.31517051, -6.777807053,
          -7.825160558, -5.7024772, -5.171264164, -5.917600347, -6.32644079, -5.833594927, -6.903698326, -5.968794788,
          -7.958800173, -6.615435064, -4.634415574, -5.867002359, -4.775557665, -4.934949676, -5.346171486,
          -6.736641391, -6.497519817, -6.25251654, -7.544873322, -8.416375079, -9.393021596, -7.35182177, -7.35182177,
          -7.423214251, -7.85156152, -8.538719643, -9.507819773, -8.569851997, -8.068754016, -7.495799977, -7.21246399,
          -7.235381958, -8.664610916, -9.625735021, -9.625735021, -8.996294549, -8.416375079, -7.281583935,
          -8.538719643, -8.153085692, -8.794260688, -8.794260688, -8.76148359, -9.355420108, -8.538719643, -5.867002359,
          -7.423214251, -7.619538969, -8.477116556, -9.625735021, -7.772835289, -8.996294549, -10.22276395,
          -9.913998282, -7.077439286, -7.121982701, -7.619538969, -7.670038896, -5.65431096, -6.108339156, -5.951662834,
          -5.606673062, -6.925039621, -5.606673062, -7.011469236, -8.326826653, -6.42065153, -6.307841426, -7.520267336,
          -7.958800173, -7.47146969, -8.728952016, -8.239087409, -7.79891912, -4.497716469, -6.216020991, -6.216020991,
          -3.0980392, -3.665315444, -4.621809049, -5.482135645, -4.034029044, -5.346171486, -6.216020991, -5.968794788,
          -6.038006529, -7.077439286, -7.569619513, -8.446639625, -9.706162223, -10.50609993, -7.423214251,
          -7.121982701, -5.985994592, -7.033348097, -7.235381958, -7.878123956, -8.664610916, -7.14442691, -8.446639625,
          -7.904849855, -7.958800173, -7.258421507, -8.297382846, -8.210230527, -8.239087409, -7.79891912, -8.664610916,
          -6.903698326, -6.757175447, -6.32644079, -7.772835289, -7.695510786, -6.090648929, -7.520267336, -7.235381958,
          -5.543957967, -6.675615401, -7.166987713, -6.635402662, -7.39928612, -8.446639625, -6.16184634, -5.917600347,
          -6.655462488, -9.136401693, -9.136401693, -9.829666607, -8.996294549, -9.871627753, -10.31517051,
          -9.913998282, -10.80921908, -9.469215565, -8.827287043, -9.788107009, -4.145392705, -5.128616245,
          -4.948500217, -4.40093375, -5.19993057, -4.934949676, -5.686362358, -6.497519817, -6.840296545, -6.840296545,
          -8.210230527, -7.14442691, -7.93174124, -9.065783148, -5.833594927, -5.421181033, -5.63837353, -6.090648929,
          -5.85026652, -6.81936665, -5.65431096, -6.126101737, -7.447274949, -8.507808873, -8.124792792, -5.71865206,
          -6.736641391, -7.904849855, -7.544873322, -8.416375079, -8.210230527, -9.546770212, -6.401645177, -7.21246399,
          -8.664610916, -9.706162223, -6.497519817, -4.736607226, -5.783960731, -6.556077263, -6.903698326,
          -8.326826653, -6.16184634, -7.39928612, -8.601209136, -5.128616245, -5.985994592, -6.757175447, -7.721132954,
          -8.664610916, -9.393021596, -11.73925197, -8.794260688, -8.356471442, -9.788107009, -6.903698326,
          -7.746907183, -8.181564121, -7.447274949, -5.228787453, -6.143937264, -6.020599913, -5.243288117,
          -6.289321377, -7.670038896, -7.328282716, -8.794260688, -5.734887386, -6.968039426, -7.721132954,
          -8.124792792, -8.728952016, -8.632794328, -8.416375079, -8.356471442, -9.746941347, -9.430951487,
          -7.904849855, -6.197887583, -6.458915609, -7.281583935, -7.695510786, -8.068754016, -5.171264164,
          -6.536470255, -6.25251654, -7.447274949, -7.93174124, -8.664610916, -8.632794328, -8.386319978, -6.695862267,
          -7.904849855, -8.632794328, -8.794260688, -7.721132954, -5.4668166, -6.126101737, -7.011469236, -7.35182177,
          -6.798537139, -5.19993057, -6.556077263, -7.281583935, -8.446639625, -8.297382846, -9.586073148, -7.878123956,
          -7.878123956, -8.601209136, -8.860566477, -8.326826653, -7.189666328, -7.986028757, -8.041003476,
          -8.827287043, -6.345120151, -6.126101737, -7.304870558, -7.304870558, -5.917600347, -6.51695137, -7.21246399,
          -8.507808873, -8.446639625, -8.538719643, -6.497519817, -7.904849855, -8.96196279, -8.239087409, -8.827287043,
          -6.777807053, -6.635402662, -7.14442691, -7.281583935, -9.065783148, -10.40958608, -7.772835289, -8.326826653,
          -6.989700043, -6.695862267, -6.216020991, -6.989700043, -4.329736338, -5.257837359, -4.989407378,
          -5.686362358, -6.655462488, -6.968039426, -7.721132954, -7.904849855, -8.894102897, -9.625735021,
          -10.45757491, -10.45757491, -10.55517328, -11.80456064, -7.746907183, -6.345120151, -6.757175447, -7.85156152,
          -6.216020991, -7.495799977, -6.51695137, -6.25251654, -7.033348097, -7.93174124, -9.318141383, -10.65501549,
          -11.73925197, -7.746907183, -7.520267336, -5.985994592, -7.35182177, -5.272435507, -2.395775166, -3.74687549,
          -4.353339357, -5.528419687, -6.536470255, -7.878123956, -6.675615401, -4.907974777, -5.421181033,
          -5.968794788, -7.258421507, -8.041003476, -6.736641391, -7.47146969, -8.794260688, -9.065783148, -5.376020021,
          -7.79891912, -7.258421507, -8.696662315, -8.297382846, -6.882461389, -6.882461389, -6.073030467, -6.51695137,
          -6.216020991, -5.30177984, -5.128616245, -6.458915609, -7.281583935, -7.544873322, -8.326826653, -8.538719643,
          -7.520267336, -6.289321377, -6.635402662, -7.447274949, -8.507808873, -8.996294549, -9.913998282,
          -9.065783148, -7.904849855, -8.297382846, -7.47146969, -8.664610916, -8.210230527, -6.090648929, -7.281583935,
          -8.124792792, -5.767541261, -6.003262785, -4.710832997, -6.090648929, -6.27087997, -6.32644079, -6.003262785,
          -5.543957967, -6.757175447]


    #arr = df.iloc[:, 0:1].to_numpy().flatten()
    arr=sb
    N_pts_FFT = 2 ** 20


    n_samples = 2 ** 14

    #(t, f, Zraw, res_name_arr) = NDF_V2.df_stft_RAW_calc(df1, Fs, fft_win, fft_win_overlap, ch_arr)












    #Noam Dahan method




    f, Pxx_spec = signal.welch(arr, Fs, 'flattop', nperseg=1535, scaling='spectrum')

    fig.add_trace(go.Scatter(x=f,
                              y=np.sqrt(Pxx_spec),
                              name='Linear PSD of S(t)',line=dict(color="red"), showlegend=True), row=1, col=1)

    # plt.title('Linear PSD of S(t)')
    # plt.ylabel('PSD Linear [V RMS]')



    Pxx_spec_dbm = 10 * np.log10((Pxx_spec / 50) * 1000)


    fig.add_trace(go.Scatter(x=f,
                              y=Pxx_spec_dbm,
                              name='logarithmic PSD of S(t)',line=dict(color="red"), showlegend=True), row=1, col=2)

    # plt.xlabel('frequency [Hz]')
    # plt.ylabel('PSD Power spectrum [dBm]')


    Y = sp.fft.fft(arr)
    Y_fft = np.abs(Y / n_samples)
    f1 = np.linspace(0.0, Fs, n_samples)
    HS_Y_fft = (2 * Y_fft[0:int(n_samples / 2) + 1]) / np.sqrt(2)

    L2 = int(n_samples / 2);
    f2 = np.linspace(0.0, ((L2 - 1) * Fs) / n_samples, L2 + 1)



    n_ffts = 2 ** 4  # 2**4 = 16 the same as asic matlab ; 2**8 = 256"

    s_df = pd.read_csv(inputFile, nrows=n_samples * n_ffts, usecols=[0]).astype(float)

    s = s_df.to_numpy().flatten()

    T = 1 / Fs;  # Sampling period
    adc_bits = 12  # ADC number of bits
    adc_res = 2 ** adc_bits  # ADC resolution
    adc_ref = 1  # ADC reference voltage



    s_data = np.reshape(s[:(len(s) // n_ffts) * n_ffts], newshape=(n_ffts, len(s) // n_ffts)).T
    # empty_s = np.zeros((n_samples,n_ffts), dtype=int)
    empty_s = np.zeros((int(n_samples / 2) + 1, n_ffts))
    for i in range(n_ffts):
        print(i, n_ffts)
        s_array = s_data[:, [i]]
        s_data2 = fft(s_array, n_samples)
        # s_data2 = fft(s_data[:,[i]],n_samples)
        empty_s[:, [i]] = s_data2
        # empty_s[:,[i]] = s_data2
    s_avg = np.sum(empty_s, axis=1) / n_ffts
    s_max = np.max(empty_s, axis=1)

    # creating x-axis that start from 0(DC) to fs/2
    f = Fs / n_samples * np.linspace(start=0, stop=int(n_samples / 2) - 1, num=int(n_samples / 2) + 1)

    s_avg_vrms = (s_avg * adc_ref) / (adc_res)
    s_avg_dbm = 10 * np.log10(((s_avg_vrms ** 2) / 50) * 1000)

    s_max_vrms = (s_max * adc_ref) / (adc_res)
    s_max_dbm = 10 * np.log10(((s_max_vrms ** 2) / 50) * 1000)

    # pd.DataFrame(s_avg_dbm, f).to_csv(csv_path_out_file_avg)
    # pd.DataFrame(s_max_dbm, f).to_csv(csv_path_out_file_max)


    fig.add_trace(go.Scatter(x=f,
                             y=s_avg_dbm,
                             name='AVG Spectrum of S(t)', line=dict(color="blue"), showlegend=True), row=2, col=1)


    fig.add_trace(go.Scatter(x=f,
                             y=s_max_dbm,
                             name='Max Hold Spectrum of S(t)', line=dict(color='red'), showlegend=True), row=2, col=1)


    yyf = np.fft.fftshift(abs(np.fft.fft(arr, N_pts_FFT)))
    fx = -Fs / 2 + (Fs / N_pts_FFT * (np.arange(0, N_pts_FFT)))



    fig.add_trace(go.Scatter(x=fx,
                              y=20 * np.log10(yyf),
                              name='Noam Dahan fft',line=dict(color="green"), showlegend=True), row=2, col=2)

    fig.add_trace(go.Scatter(x=fx,
                              y=    10 * np.log10(((yyf ** 2) / 50) * 1000),
                              name='Noam Dahan fft DBM',line=dict(color="green"), showlegend=True), row=2, col=2)


    fig.write_html("dft.html", config={'scrollZoom': True, 'responsive': False},
                    auto_open=True)

if __name__ == "__main__":
    main()

